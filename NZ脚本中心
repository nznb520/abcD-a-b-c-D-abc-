-- NZ脚本中心悬浮球终极版
-- 主作者:南烛

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

-- 创建主屏幕GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "NZScriptCenterFloatingBallUltimate"
ScreenGui.Parent = game.CoreGui

-- 创建卡密验证界面
local KeyFrame = Instance.new("Frame")
KeyFrame.Name = "KeyFrame"
KeyFrame.Size = UDim2.new(0, 450, 0, 300)
KeyFrame.Position = UDim2.new(0.5, -225, 0.5, -150)
KeyFrame.BackgroundColor3 = Color3.new(0.08, 0.08, 0.16)
KeyFrame.BorderSizePixel = 0
KeyFrame.Parent = ScreenGui

-- 3D卡片效果
local CardEffect = Instance.new("ImageLabel")
CardEffect.Name = "CardEffect"
CardEffect.Size = UDim2.new(1, 0, 1, 0)
CardEffect.Image = "rbxassetid://5553946656"
CardEffect.ImageColor3 = Color3.new(0.2, 0, 0.4)
CardEffect.ScaleType = Enum.ScaleType.Slice
CardEffect.SliceCenter = Rect.new(24, 24, 24, 24)
CardEffect.Parent = KeyFrame

-- 卡密验证标题
local KeyTitle = Instance.new("TextLabel")
KeyTitle.Name = "KeyTitle"
KeyTitle.Text = "NZ脚本中心 - 安全验证"
KeyTitle.Size = UDim2.new(1, 0, 0, 60)
KeyTitle.Position = UDim2.new(0, 0, 0, 20)
KeyTitle.BackgroundTransparency = 1
KeyTitle.TextColor3 = Color3.new(1, 1, 1)
KeyTitle.TextSize = 28
KeyTitle.Font = Enum.Font.GothamBold
KeyTitle.Parent = KeyFrame

-- 卡密输入框
local KeyInput = Instance.new("TextBox")
KeyInput.Name = "KeyInput"
KeyInput.PlaceholderText = "请输入您的卡密"
KeyInput.Size = UDim2.new(0.8, 0, 0, 45)
KeyInput.Position = UDim2.new(0.1, 0, 0.3, 0)
KeyInput.BackgroundColor3 = Color3.new(0.15, 0.15, 0.25)
KeyInput.TextColor3 = Color3.new(1, 1, 1)
KeyInput.TextSize = 20
KeyInput.Font = Enum.Font.Gotham
KeyInput.Parent = KeyFrame

-- 验证按钮
local VerifyButton = Instance.new("TextButton")
VerifyButton.Name = "VerifyButton"
VerifyButton.Text = "验 证"
VerifyButton.Size = UDim2.new(0.6, 0, 0, 50)
VerifyButton.Position = UDim2.new(0.2, 0, 0.5, 0)
VerifyButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.6)
VerifyButton.TextColor3 = Color3.new(1, 1, 1)
VerifyButton.TextSize = 22
VerifyButton.Font = Enum.Font.GothamBold
VerifyButton.Parent = KeyFrame

-- 群信息
local GroupInfo = Instance.new("TextLabel")
GroupInfo.Name = "GroupInfo"
GroupInfo.Text = "进入QQ群:813128648 获取卡密"
GroupInfo.Size = UDim2.new(1, 0, 0, 30)
GroupInfo.Position = UDim2.new(0, 0, 0.7, 0)
GroupInfo.BackgroundTransparency = 1
GroupInfo.TextColor3 = Color3.new(0.8, 0.8, 1)
GroupInfo.TextSize = 16
GroupInfo.Parent = KeyFrame

-- 复制群号按钮
local CopyButton = Instance.new("TextButton")
CopyButton.Name = "CopyButton"
CopyButton.Text = "复制群号"
CopyButton.Size = UDim2.new(0.4, 0, 0, 35)
CopyButton.Position = UDim2.new(0.3, 0, 0.8, 0)
CopyButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
CopyButton.TextColor3 = Color3.new(1, 1, 1)
CopyButton.Parent = KeyFrame

-- 创建欢迎界面
local WelcomeFrame = Instance.new("Frame")
WelcomeFrame.Name = "WelcomeFrame"
WelcomeFrame.Size = UDim2.new(0, 500, 0, 400)
WelcomeFrame.Position = UDim2.new(0.5, -250, 0.5, -200)
WelcomeFrame.BackgroundColor3 = Color3.new(0.05, 0.05, 0.15)
WelcomeFrame.BorderSizePixel = 0
WelcomeFrame.Visible = false
WelcomeFrame.Parent = ScreenGui

-- 欢迎背景
local WelcomeBackground = Instance.new("ImageLabel")
WelcomeBackground.Name = "WelcomeBackground"
WelcomeBackground.Size = UDim2.new(1, 0, 1, 0)
WelcomeBackground.Image = "rbxassetid://5553946656"
WelcomeBackground.ImageColor3 = Color3.new(0.1, 0.1, 0.3)
WelcomeBackground.ScaleType = Enum.ScaleType.Slice
WelcomeBackground.SliceCenter = Rect.new(24, 24, 24, 24)
WelcomeBackground.Parent = WelcomeFrame

-- 欢迎图片
local WelcomeImage = Instance.new("ImageLabel")
WelcomeImage.Name = "WelcomeImage"
WelcomeImage.Size = UDim2.new(0, 300, 0, 200)
WelcomeImage.Position = UDim2.new(0.5, -150, 0.2, -100)
WelcomeImage.Image = "rbxassetid://123947581167369"
WelcomeImage.BackgroundTransparency = 1
WelcomeImage.Parent = WelcomeFrame

-- 欢迎文本
local WelcomeText = Instance.new("TextLabel")
WelcomeText.Name = "WelcomeText"
WelcomeText.Text = "欢迎使用NZ脚本中心"
WelcomeText.Size = UDim2.new(1, 0, 0, 60)
WelcomeText.Position = UDim2.new(0, 0, 0.6, 0)
WelcomeText.BackgroundTransparency = 1
WelcomeText.TextColor3 = Color3.new(0, 1, 1)
WelcomeText.TextSize = 32
WelcomeText.Font = Enum.Font.GothamBold
WelcomeText.Parent = WelcomeFrame

-- 继续按钮
local ContinueButton = Instance.new("TextButton")
ContinueButton.Name = "ContinueButton"
ContinueButton.Text = "继续"
ContinueButton.Size = UDim2.new(0.4, 0, 0, 50)
ContinueButton.Position = UDim2.new(0.3, 0, 0.8, 0)
ContinueButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.6)
ContinueButton.TextColor3 = Color3.new(1, 1, 1)
ContinueButton.TextSize = 24
ContinueButton.Font = Enum.Font.GothamBold
ContinueButton.Parent = WelcomeFrame

-- 创建主弹窗
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 600, 0, 450)
MainFrame.Position = UDim2.new(0.5, -300, 0.5, -225)
MainFrame.BackgroundColor3 = Color3.new(0.05, 0.05, 0.15)
MainFrame.BorderSizePixel = 0
MainFrame.Visible = false
MainFrame.Parent = ScreenGui

-- 星空背景
local SpaceBackground = Instance.new("ImageLabel")
SpaceBackground.Name = "SpaceBackground"
SpaceBackground.Size = UDim2.new(1, 0, 1, 0)
SpaceBackground.Image = "rbxassetid://1328157353"
SpaceBackground.ScaleType = Enum.ScaleType.Crop
SpaceBackground.Parent = MainFrame

-- 标题栏
local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Size = UDim2.new(1, 0, 0, 40)
TitleBar.BackgroundColor3 = Color3.new(0.1, 0.1, 0.3)
TitleBar.Parent = MainFrame

-- 标题文本
local TitleText = Instance.new("TextLabel")
TitleText.Name = "TitleText"
TitleText.Text = "NZ脚本中心"
TitleText.Size = UDim2.new(0, 150, 1, 0)
TitleText.Position = UDim2.new(0, 10, 0, 0)
TitleText.BackgroundTransparency = 1
TitleText.TextColor3 = Color3.new(1, 1, 1)
TitleText.TextSize = 24
TitleText.Font = Enum.Font.GothamBold
TitleText.TextXAlignment = Enum.TextXAlignment.Left
TitleText.Parent = TitleBar

-- 作者信息
local AuthorText = Instance.new("TextLabel")
AuthorText.Name = "AuthorText"
AuthorText.Text = "主作者:南烛"
AuthorText.Size = UDim2.new(0, 120, 1, 0)
AuthorText.Position = UDim2.new(0, 170, 0, 0)
AuthorText.BackgroundTransparency = 1
AuthorText.TextColor3 = Color3.new(0, 1, 1)
AuthorText.TextSize = 16
AuthorText.Font = Enum.Font.Gotham
AuthorText.TextXAlignment = Enum.TextXAlignment.Left
AuthorText.Parent = TitleBar

-- 最小化按钮
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Text = "-"
MinimizeButton.Size = UDim2.new(0, 30, 0, 30)
MinimizeButton.Position = UDim2.new(1, -70, 0, 5)
MinimizeButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
MinimizeButton.TextColor3 = Color3.new(1, 1, 1)
MinimizeButton.Parent = TitleBar

-- 关闭按钮
local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Text = "×"
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Position = UDim2.new(1, -35, 0, 5)
CloseButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
CloseButton.TextColor3 = Color3.new(1, 1, 1)
CloseButton.Parent = TitleBar

-- 圆形悬浮球按钮
local FloatingBall = Instance.new("ImageButton")
FloatingBall.Name = "FloatingBall"
FloatingBall.Size = UDim2.new(0, 50, 0, 50)
FloatingBall.Position = UDim2.new(1, -60, 0.5, -25)
FloatingBall.Image = "rbxassetid://137091327012662"
FloatingBall.BackgroundTransparency = 1
FloatingBall.Visible = false
FloatingBall.Parent = ScreenGui

-- 圆角效果
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(1, 0)
UICorner.Parent = FloatingBall

-- 左侧导航栏
local NavBar = Instance.new("Frame")
NavBar.Name = "NavBar"
NavBar.Size = UDim2.new(0, 120, 1, -40)
NavBar.Position = UDim2.new(0, 0, 0, 40)
NavBar.BackgroundColor3 = Color3.new(0.07, 0.07, 0.17)
NavBar.Parent = MainFrame

-- 导航栏分隔线
local NavDivider = Instance.new("Frame")
NavDivider.Name = "NavDivider"
NavDivider.Size = UDim2.new(0, 2, 1, 0)
NavDivider.Position = UDim2.new(1, 0, 0, 0)
NavDivider.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
NavDivider.BorderSizePixel = 0
NavDivider.Parent = NavBar

-- 开发团队按钮
local DevTeamButton = Instance.new("TextButton")
DevTeamButton.Name = "DevTeamButton"
DevTeamButton.Text = "开发团队"
DevTeamButton.Size = UDim2.new(1, -10, 0, 40)
DevTeamButton.Position = UDim2.new(0, 5, 0, 10)
DevTeamButton.BackgroundColor3 = Color3.new(0.15, 0.15, 0.3)
DevTeamButton.TextColor3 = Color3.new(1, 1, 1)
DevTeamButton.Parent = NavBar

-- 通用功能按钮
local GeneralButton = Instance.new("TextButton")
GeneralButton.Name = "GeneralButton"
GeneralButton.Text = "通用功能"
GeneralButton.Size = UDim2.new(1, -10, 0, 40)
GeneralButton.Position = UDim2.new(0, 5, 0, 60)
GeneralButton.BackgroundColor3 = Color3.new(0.15, 0.15, 0.3)
GeneralButton.TextColor3 = Color3.new(1, 1, 1)
GeneralButton.Parent = NavBar

-- ESP功能按钮
local ESPButton = Instance.new("TextButton")
ESPButton.Name = "ESPButton"
ESPButton.Text = "ESP功能"
ESPButton.Size = UDim2.new(1, -10, 0, 40)
ESPButton.Position = UDim2.new(0, 5, 0, 110)
ESPButton.BackgroundColor3 = Color3.new(0.1, 0.1, 0.2)
ESPButton.TextColor3 = Color3.new(1, 1, 1)
ESPButton.Parent = NavBar

-- 其他脚本按钮
local OtherScriptsButton = Instance.new("TextButton")
OtherScriptsButton.Name = "OtherScriptsButton"
OtherScriptsButton.Text = "其他脚本"
OtherScriptsButton.Size = UDim2.new(1, -10, 0, 40)
OtherScriptsButton.Position = UDim2.new(0, 5, 0, 160)
OtherScriptsButton.BackgroundColor3 = Color3.new(0.1, 0.1, 0.2)
OtherScriptsButton.TextColor3 = Color3.new(1, 1, 1)
OtherScriptsButton.Parent = NavBar

-- 一键汉化按钮
local ChineseButton = Instance.new("TextButton")
ChineseButton.Name = "ChineseButton"
ChineseButton.Text = "一键汉化"
ChineseButton.Size = UDim2.new(1, -10, 0, 40)
ChineseButton.Position = UDim2.new(0, 5, 0, 210)
ChineseButton.BackgroundColor3 = Color3.new(0.1, 0.1, 0.2)
ChineseButton.TextColor3 = Color3.new(1, 1, 1)
ChineseButton.Parent = NavBar

-- 海贼战争按钮
local PirateWarButton = Instance.new("TextButton")
PirateWarButton.Name = "PirateWarButton"
PirateWarButton.Text = "海贼战争"
PirateWarButton.Size = UDim2.new(1, -10, 0, 40)
PirateWarButton.Position = UDim2.new(0, 5, 0, 260)
PirateWarButton.BackgroundColor3 = Color3.new(0.1, 0.1, 0.2)
PirateWarButton.TextColor3 = Color3.new(1, 1, 1)
PirateWarButton.Parent = NavBar

-- 右侧内容区域
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Size = UDim2.new(1, -130, 1, -50)
ContentFrame.Position = UDim2.new(0, 125, 0, 45)
ContentFrame.BackgroundTransparency = 1
ContentFrame.Parent = MainFrame

-- 开发团队页面
local DevTeamFrame = Instance.new("Frame")
DevTeamFrame.Name = "DevTeamFrame"
DevTeamFrame.Size = UDim2.new(1, 0, 1, 0)
DevTeamFrame.BackgroundTransparency = 1
DevTeamFrame.Visible = false
DevTeamFrame.Parent = ContentFrame

-- 作者留言
local AuthorMessage = Instance.new("TextLabel")
AuthorMessage.Name = "AuthorMessage"
AuthorMessage.Text = "欢迎使用本脚本！为确保脚本功能稳定及账号安全，严禁将脚本配套的卡密外传或分享给他人，违规可能导致卡密失效，感谢你的配合！"
AuthorMessage.Size = UDim2.new(1, -20, 0, 120)
AuthorMessage.Position = UDim2.new(0, 10, 0, 10)
AuthorMessage.BackgroundTransparency = 1
AuthorMessage.TextColor3 = Color3.new(0, 1, 1)
AuthorMessage.TextSize = 16
AuthorMessage.TextWrapped = true
AuthorMessage.Font = Enum.Font.GothamBold
AuthorMessage.Parent = DevTeamFrame

-- 开发人员信息
local DeveloperInfo = Instance.new("TextLabel")
DeveloperInfo.Name = "DeveloperInfo"
DeveloperInfo.Text = "开发团队:\n主作者:南烛\n副作者:逍遥\n经理:深拥情话梦一场\n代理:孙笑川\n代理:以后\n代理:星云\n星云大号:相信"
DeveloperInfo.Size = UDim2.new(1, -20, 0, 180)
DeveloperInfo.Position = UDim2.new(0, 10, 0, 140)
DeveloperInfo.BackgroundTransparency = 1
DeveloperInfo.TextColor3 = Color3.new(1, 0.5, 0)
DeveloperInfo.TextSize = 18
DeveloperInfo.TextWrapped = true
DeveloperInfo.Font = Enum.Font.GothamBold
DeveloperInfo.Parent = DevTeamFrame

-- 通用功能页面
local GeneralFrame = Instance.new("Frame")
GeneralFrame.Name = "GeneralFrame"
GeneralFrame.Size = UDim2.new(1, 0, 1, 0)
GeneralFrame.BackgroundTransparency = 1
GeneralFrame.Visible = true
GeneralFrame.Parent = ContentFrame

-- 无敌少侠飞行
local FlightButton = Instance.new("TextButton")
FlightButton.Name = "FlightButton"
FlightButton.Text = "无敌少侠飞行"
FlightButton.Size = UDim2.new(1, 0, 0, 40)
FlightButton.Position = UDim2.new(0, 0, 0, 10)
FlightButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
FlightButton.TextColor3 = Color3.new(1, 1, 1)
FlightButton.Parent = GeneralFrame

-- 快速旋转
local FastSpinButton = Instance.new("TextButton")
FastSpinButton.Name = "FastSpinButton"
FastSpinButton.Text = "快速旋转 (速度50)"
FastSpinButton.Size = UDim2.new(1, 0, 0, 40)
FastSpinButton.Position = UDim2.new(0, 0, 0, 60)
FastSpinButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
FastSpinButton.TextColor3 = Color3.new(1, 1, 1)
FastSpinButton.Parent = GeneralFrame

-- 极速旋转
local SuperSpinButton = Instance.new("TextButton")
SuperSpinButton.Name = "SuperSpinButton"
SuperSpinButton.Text = "极速旋转 (速度100)"
SuperSpinButton.Size = UDim2.new(1, 0, 0, 40)
SuperSpinButton.Position = UDim2.new(0, 0, 0, 110)
SuperSpinButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
SuperSpinButton.TextColor3 = Color3.new(1, 1, 1)
SuperSpinButton.Parent = GeneralFrame

-- 无限跳
local InfiniteJumpButton = Instance.new("TextButton")
InfiniteJumpButton.Name = "InfiniteJumpButton"
InfiniteJumpButton.Text = "无限跳跃"
InfiniteJumpButton.Size = UDim2.new(1, 0, 0, 40)
InfiniteJumpButton.Position = UDim2.new(0, 0, 0, 160)
InfiniteJumpButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
InfiniteJumpButton.TextColor3 = Color3.new(1, 1, 1)
InfiniteJumpButton.Parent = GeneralFrame

-- 夜视功能
local NightVisionButton = Instance.new("TextButton")
NightVisionButton.Name = "NightVisionButton"
NightVisionButton.Text = "夜视功能"
NightVisionButton.Size = UDim2.new(1, 0, 0, 40)
NightVisionButton.Position = UDim2.new(0, 0, 0, 210)
NightVisionButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
NightVisionButton.TextColor3 = Color3.new(1, 1, 1)
NightVisionButton.Parent = GeneralFrame

-- ESP功能页面
local ESPFrame = Instance.new("Frame")
ESPFrame.Name = "ESPFrame"
ESPFrame.Size = UDim2.new(1, 0, 1, 0)
ESPFrame.BackgroundTransparency = 1
ESPFrame.Visible = false
ESPFrame.Parent = ContentFrame

-- ESP开关
local ESPToggle = Instance.new("TextButton")
ESPToggle.Name = "ESPToggle"
ESPToggle.Text = "开启ESP"
ESPToggle.Size = UDim2.new(1, 0, 0, 40)
ESPToggle.Position = UDim2.new(0, 0, 0, 10)
ESPToggle.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
ESPToggle.TextColor3 = Color3.new(1, 1, 1)
ESPToggle.Parent = ESPFrame

-- 队伍检测开关
local TeamDetectToggle = Instance.new("TextButton")
TeamDetectToggle.Name = "TeamDetectToggle"
TeamDetectToggle.Text = "开启队伍检测"
TeamDetectToggle.Size = UDim2.new(1, 0, 0, 40)
TeamDetectToggle.Position = UDim2.new(0, 0, 0, 60)
TeamDetectToggle.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
TeamDetectToggle.TextColor3 = Color3.new(1, 1, 1)
TeamDetectToggle.Parent = ESPFrame

-- 其他脚本页面
local OtherScriptsFrame = Instance.new("Frame")
OtherScriptsFrame.Name = "OtherScriptsFrame"
OtherScriptsFrame.Size = UDim2.new(1, 0, 1, 0)
OtherScriptsFrame.BackgroundTransparency = 1
OtherScriptsFrame.Visible = false
OtherScriptsFrame.Parent = ContentFrame

-- SN.hub脚本按钮
local SNHubButton = Instance.new("TextButton")
SNHubButton.Name = "SNHubButton"
SNHubButton.Text = "SN.hub"
SNHubButton.Size = UDim2.new(1, 0, 0, 40)
SNHubButton.Position = UDim2.new(0, 0, 0, 10)
SNHubButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
SNHubButton.TextColor3 = Color3.new(1, 1, 1)
SNHubButton.Parent = OtherScriptsFrame

-- 叶脚本按钮
local YeScriptButton = Instance.new("TextButton")
YeScriptButton.Name = "YeScriptButton"
YeScriptButton.Text = "叶脚本"
YeScriptButton.Size = UDim2.new(1, 0, 0, 40)
YeScriptButton.Position = UDim2.new(0, 0, 0, 60)
YeScriptButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
YeScriptButton.TextColor3 = Color3.new(1, 1, 1)
YeScriptButton.Parent = OtherScriptsFrame

-- 天脚本按钮
local TianScriptButton = Instance.new("TextButton")
TianScriptButton.Name = "TianScriptButton"
TianScriptButton.Text = "天脚本"
TianScriptButton.Size = UDim2.new(1, 0, 0, 40)
TianScriptButton.Position = UDim2.new(0, 0, 0, 110)
TianScriptButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
TianScriptButton.TextColor3 = Color3.new(1, 1, 1)
TianScriptButton.Parent = OtherScriptsFrame

-- TX.退休脚本按钮
local TXRetireButton = Instance.new("TextButton")
TXRetireButton.Name = "TXRetireButton"
TXRetireButton.Text = "TX.退休"
TXRetireButton.Size = UDim2.new(1, 0, 0, 40)
TXRetireButton.Position = UDim2.new(0, 0, 0, 160)
TXRetireButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
TXRetireButton.TextColor3 = Color3.new(1, 1, 1)
TXRetireButton.Parent = OtherScriptsFrame

-- 一键汉化页面
local ChineseFrame = Instance.new("Frame")
ChineseFrame.Name = "ChineseFrame"
ChineseFrame.Size = UDim2.new(1, 0, 1, 0)
ChineseFrame.BackgroundTransparency = 1
ChineseFrame.Visible = false
ChineseFrame.Parent = ContentFrame

-- 汉化按钮
local ChineseButton = Instance.new("TextButton")
ChineseButton.Name = "ChineseButton"
ChineseButton.Text = "一键汉化英文脚本"
ChineseButton.Size = UDim2.new(1, 0, 0, 40)
ChineseButton.Position = UDim2.new(0, 0, 0, 10)
ChineseButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
ChineseButton.TextColor3 = Color3.new(1, 1, 1)
ChineseButton.Parent = ChineseFrame

-- 海贼战争页面
local PirateWarFrame = Instance.new("Frame")
PirateWarFrame.Name = "PirateWarFrame"
PirateWarFrame.Size = UDim2.new(1, 0, 1, 0)
PirateWarFrame.BackgroundTransparency = 1
PirateWarFrame.Visible = false
PirateWarFrame.Parent = ContentFrame

-- 移除冷却按钮
local RemoveCooldownButton = Instance.new("TextButton")
RemoveCooldownButton.Name = "RemoveCooldownButton"
RemoveCooldownButton.Text = "移除所有冷却"
RemoveCooldownButton.Size = UDim2.new(1, 0, 0, 40)
RemoveCooldownButton.Position = UDim2.new(0, 0, 0, 10)
RemoveCooldownButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.4)
RemoveCooldownButton.TextColor3 = Color3.new(1, 1, 1)
RemoveCooldownButton.Parent = PirateWarFrame

-- 状态提示
local StatusText = Instance.new("TextLabel")
StatusText.Name = "StatusText"
StatusText.Text = "就绪"
StatusText.Size = UDim2.new(1, 0, 0, 20)
StatusText.Position = UDim2.new(0, 0, 1, -25)
StatusText.BackgroundTransparency = 1
StatusText.TextColor3 = Color3.new(0, 1, 0)
StatusText.TextSize = 14
StatusText.Font = Enum.Font.SourceSans
StatusText.TextXAlignment = Enum.TextXAlignment.Left
StatusText.Parent = ContentFrame

-- 通知弹窗
local Notification = Instance.new("TextLabel")
Notification.Name = "Notification"
Notification.Text = ""
Notification.Size = UDim2.new(0, 300, 0, 40)
Notification.Position = UDim2.new(1, -310, 0, 10)
Notification.BackgroundColor3 = Color3.new(0.1, 0.1, 0.3)
Notification.TextColor3 = Color3.new(1, 1, 1)
Notification.TextSize = 18
Notification.Visible = false
Notification.Parent = MainFrame

-- 圆角效果
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = Notification

-- 变量
local isDragging = false
local dragStartPos = Vector2.new(0, 0)
local frameStartPos = UDim2.new(0, 0, 0, 0)
local isRestoreDragging = false
local restoreStartPos = Vector2.new(0, 0)
local buttonStartPos = UDim2.new(0, 0, 0, 0)
local espEnabled = false
local teamDetectEnabled = false
local espHighlights = {}
local correctKey = "nznb666"
local verifiedPlayers = {}
local fastSpinEnabled = false
local superSpinEnabled = false
local infiniteJumpEnabled = false
local nightVisionEnabled = false
local fastSpinConnection = nil
local superSpinConnection = nil
local infiniteJumpConnection = nil

-- 复制群号功能
CopyButton.MouseButton1Click:Connect(function()
    local clipboard = setclipboard or toclipboard or set_clipboard or (Clipboard and Clipboard.set)
    if clipboard then
        clipboard("813128648")
        StatusText.Text = "群号已复制到剪贴板"
    else
        StatusText.Text = "无法复制，请手动复制群号"
    end
end)

-- 验证卡密功能
VerifyButton.MouseButton1Click:Connect(function()
    if KeyInput.Text == correctKey then
        verifiedPlayers[LocalPlayer.UserId] = true
        KeyFrame.Visible = false
        WelcomeFrame.Visible = true
        StatusText.Text = "验证成功，欢迎使用"
    else
        KeyInput.Text = ""
        KeyInput.PlaceholderText = "卡密错误，请重新输入"
        StatusText.Text = "卡密错误"
        LocalPlayer:Kick("Wrong card.")
    end
end)

-- 继续按钮功能
ContinueButton.MouseButton1Click:Connect(function()
    WelcomeFrame.Visible = false
    MainFrame.Visible = true
    FloatingBall.Visible = true
    StatusText.Text = "进入主界面"
end)

-- 悬浮球按钮功能
FloatingBall.MouseButton1Click:Connect(function()
    if MainFrame.Visible then
        MainFrame.Visible = false
        FloatingBall.Image = "rbxassetid://137091327012662"
        StatusText.Text = "界面已隐藏"
    else
        MainFrame.Visible = true
        FloatingBall.Image = "rbxassetid://108010245085057"
        StatusText.Text = "界面已显示"
    end
end)

-- 最小化按钮功能
MinimizeButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
    FloatingBall.Visible = true
    StatusText.Text = "界面已最小化"
end)

-- 关闭按钮功能
CloseButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
    FloatingBall.Visible = true
    StatusText.Text = "界面已关闭"
end)

-- 拖动主窗口
TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        isDragging = true
        dragStartPos = Vector2.new(input.Position.X, input.Position.Y)
        frameStartPos = MainFrame.Position
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        if isDragging then
            local delta = Vector2.new(input.Position.X, input.Position.Y) - dragStartPos
            MainFrame.Position = UDim2.new(frameStartPos.X.Scale, frameStartPos.X.Offset + delta.X, 
                                          frameStartPos.Y.Scale, frameStartPos.Y.Offset + delta.Y)
        end
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        isDragging = false
    end
end)

-- 无敌少侠飞行功能
FlightButton.MouseButton1Click:Connect(function()
    StatusText.Text = "正在加载飞行脚本..."
    loadstring(game:HttpGet("https://rawscripts.net/raw/Universal-Script-Invinicible-Flight-R15-45414"))()
    showNotification("无敌少侠飞行 - 执行成功")
    StatusText.Text = "飞行功能已加载"
end)

-- 快速旋转功能
FastSpinButton.MouseButton1Click:Connect(function()
    fastSpinEnabled = not fastSpinEnabled
    
    if fastSpinEnabled then
        StatusText.Text = "快速旋转已激活"
        FastSpinButton.Text = "关闭快速旋转"
        showNotification("快速旋转 - 执行成功")
        
        -- 停止极速旋转如果正在运行
        if superSpinEnabled then
            if superSpinConnection then
                superSpinConnection:Disconnect()
                superSpinConnection = nil
            end
            superSpinEnabled = false
            SuperSpinButton.Text = "极速旋转 (速度100)"
        end
        
        -- 开始快速旋转
        fastSpinConnection = RunService.Heartbeat:Connect(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                LocalPlayer.Character.HumanoidRootPart.CFrame = LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.Angles(0, math.rad(50), 0)
            end
        end)
    else
        StatusText.Text = "快速旋转已关闭"
        FastSpinButton.Text = "快速旋转 (速度50)"
        
        -- 停止快速旋转
        if fastSpinConnection then
            fastSpinConnection:Disconnect()
            fastSpinConnection = nil
        end
    end
end)

-- 极速旋转功能
SuperSpinButton.MouseButton1Click:Connect(function()
    superSpinEnabled = not superSpinEnabled
    
    if superSpinEnabled then
        StatusText.Text = "极速旋转已激活"
        SuperSpinButton.Text = "关闭极速旋转"
        showNotification("极速旋转 - 执行成功")
        
        -- 停止快速旋转如果正在运行
        if fastSpinEnabled then
            if fastSpinConnection then
                fastSpinConnection:Disconnect()
                fastSpinConnection = nil
            end
            fastSpinEnabled = false
            FastSpinButton.Text = "快速旋转 (速度50)"
        end
        
        -- 开始极速旋转
        superSpinConnection = RunService.Heartbeat:Connect(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                LocalPlayer.Character.HumanoidRootPart.CFrame = LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.Angles(0, math.rad(100), 0)
            end
        end)
    else
        StatusText.Text = "极速旋转已关闭"
        SuperSpinButton.Text = "极速旋转 (速度100)"
        
        -- 停止极速旋转
        if superSpinConnection then
            superSpinConnection:Disconnect()
            superSpinConnection = nil
        end
    end
end)

-- 无限跳功能
InfiniteJumpButton.MouseButton1Click:Connect(function()
    infiniteJumpEnabled = not infiniteJumpEnabled
    
    if infiniteJumpEnabled then
        StatusText.Text = "无限跳跃已激活"
        InfiniteJumpButton.Text = "关闭无限跳跃"
        showNotification("无限跳跃 - 执行成功")
        
        -- 开始无限跳
        infiniteJumpConnection = UserInputService.JumpRequest:Connect(function()
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                LocalPlayer.Character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end)
    else
        StatusText.Text = "无限跳跃已关闭"
        InfiniteJumpButton.Text = "无限跳跃"
        
        -- 停止无限跳
        if infiniteJumpConnection then
            infiniteJumpConnection:Disconnect()
            infiniteJumpConnection = nil
        end
    end
end)

-- 夜视功能
NightVisionButton.MouseButton1Click:Connect(function()
    nightVisionEnabled = not nightVisionEnabled
    
    if nightVisionEnabled then
        StatusText.Text = "夜视功能已激活"
        NightVisionButton.Text = "关闭夜视"
        showNotification("夜视功能 - 执行成功")
        
        -- 提高环境亮度
        Lighting.Brightness = 2
        Lighting.Ambient = Color3.new(1, 1, 1)
        Lighting.OutdoorAmbient = Color3.new(1, 1, 1)
    else
        StatusText.Text = "夜视功能已关闭"
        NightVisionButton.Text = "夜视功能"
        
        -- 恢复默认亮度
        Lighting.Brightness = 1
        Lighting.Ambient = Color3.new(0.5, 0.5, 0.5)
        Lighting.OutdoorAmbient = Color3.new(0.5, 0.5, 0.5)
    end
end)

-- ESP开关功能
ESPToggle.MouseButton1Click:Connect(function()
    espEnabled = not espEnabled
    
    if espEnabled then
        ESPToggle.Text = "关闭ESP"
        StatusText.Text = "ESP已开启"
        showNotification("ESP功能 - 执行成功")
    else
        ESPToggle.Text = "开启ESP"
        StatusText.Text = "ESP已关闭"
    end
    
    updateESP()
end)

-- 队伍检测开关功能
TeamDetectToggle.MouseButton1Click:Connect(function()
    teamDetectEnabled = not teamDetectEnabled
    
    if teamDetectEnabled then
        TeamDetectToggle.Text = "关闭队伍检测"
        StatusText.Text = "队伍检测已开启"
    else
        TeamDetectToggle.Text = "开启队伍检测"
        StatusText.Text = "队伍检测已关闭"
    end
    
    if espEnabled then
        updateESP()
    end
end)

-- 一键汉化功能
ChineseButton.MouseButton1Click:Connect(function()
    StatusText.Text = "正在检测并汉化英文脚本..."
    showNotification("一键汉化 - 执行中")
    
    -- 这里添加汉化逻辑
    -- 实际实现需要根据具体脚本结构进行文本替换
    
    StatusText.Text = "汉化完成"
    showNotification("一键汉化 - 执行成功")
end)

-- 移除冷却功能
RemoveCooldownButton.MouseButton1Click:Connect(function()
    StatusText.Text = "正在移除所有冷却时间..."
    showNotification("移除冷却 - 执行中")
    
    -- 移除所有道具的冷却时间
    for _, tool in pairs(game:GetService("Workspace"):GetDescendants()) do
        if tool:IsA("Tool") then
            tool.Cooldown.Value = 0
        end
    end
    
    StatusText.Text = "所有冷却时间已移除"
    showNotification("移除冷却 - 执行成功")
end)

-- 其他脚本功能
SNHubButton.MouseButton1Click:Connect(function()
    StatusText.Text = "正在加载SN.hub脚本..."
    showNotification("SN.hub - 执行中")
    loadstring("\108\111\97\100\115\116\114\105\110\103\40\103\97\109\101\58\72\116\116\112\71\101\116\40\34\104\116\116\112\115\58\47\47\114\97\119\46\103\105\116\104\117\98\117\115\101\114\99\111\110\116\101\110\116\46\99\111\109\47\120\105\97\110\105\110\103\49\53\49\47\83\78\72\85\66\47\109\97\105\110\47\83\78\104\117\98\46\108\117\97\34\41\41\40\41")
    showNotification("SN.hub - 执行成功")
    StatusText.Text = "SN.hub脚本已加载"
end)

YeScriptButton.MouseButton1Click:Connect(function()
    StatusText.Text = "正在加载叶脚本..."
    showNotification("叶脚本 - 执行中")
    loadstring(game:HttpGet("https://raw.githubusercontent.com/roblox-ye/QQ515966991/refs/heads/main/ROBLOX-CNVIP-XIAOYE.lua"))()
    showNotification("叶脚本 - 执行成功")
    StatusText.Text = "叶脚本已加载"
end)

TianScriptButton.MouseButton1Click:Connect(function()
    StatusText.Text = "正在加载天脚本..."
    showNotification("天脚本 - 执行中")
    loadstring(game:HttpGet("https://raw.githubusercontent.com/lyyanai/tianscript/refs/heads/main/ScriptHub.lua"))()
    showNotification("天脚本 - 执行成功")
    StatusText.Text = "天脚本已加载"
end)

TXRetireButton.MouseButton1Click:Connect(function()
    StatusText.Text = "正在加载TX.退休脚本..."
    showNotification("TX.退休 - 执行中")
    TX = "脚本群:160369111"
    Script = "Free永久免费"
    loadstring(game:HttpGet("https://raw.githubusercontent.com/JsYb666/TX-Free-YYDS/refs/heads/main/FREE-TX-TEAM"))()
    showNotification("TX.退休 - 执行成功")
    StatusText.Text = "TX.退休脚本已加载"
end)

-- 更新ESP显示
local function updateESP()
    -- 清除现有高亮
    for _, highlight in pairs(espHighlights) do
        highlight:Destroy()
    end
    espHighlights = {}
    
    if not espEnabled then return end
    
    -- 为所有玩家添加高亮
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local highlight = Instance.new("Highlight")
            highlight.Parent = player.Character
            
            -- 设置颜色
            if teamDetectEnabled then
                -- 队伍检测开启时，队友绿色，敌人红色
                if player.Team == LocalPlayer.Team then
                    highlight.FillColor = Color3.new(0, 1, 0)  -- 队友绿色
                    highlight.OutlineColor = Color3.new(0, 0.8, 0)
                else
                    highlight.FillColor = Color3.new(1, 0, 0)  -- 敌人红色
                    highlight.OutlineColor = Color3.new(0.8, 0, 0)
                end
            else
                -- 队伍检测关闭时，统一白色
                highlight.FillColor = Color3.new(1, 1, 1)  -- 白色
                highlight.OutlineColor = Color3.new(0.8, 0.8, 0.8)
            end
            
            table.insert(espHighlights, highlight)
        end
    end
end

-- 玩家加入/离开时更新ESP
Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function(character)
        if espEnabled then
            updateESP()
        end
    end)
end)

Players.PlayerRemoving:Connect(function(player)
    if espEnabled then
        updateESP()
    end
end)

-- 角色重生时更新ESP
LocalPlayer.CharacterAdded:Connect(function(character)
    if espEnabled then
        updateESP()
    end
end)

-- 队伍变化时更新ESP
LocalPlayer:GetPropertyChangedSignal("Team"):Connect(function()
    if espEnabled and teamDetectEnabled then
        updateESP()
    end
end)

-- 角色重生时重新连接功能
LocalPlayer.CharacterAdded:Connect(function(character)
    -- 重新连接快速旋转
    if fastSpinEnabled then
        if fastSpinConnection then
            fastSpinConnection:Disconnect()
        end
        fastSpinConnection = RunService.Heartbeat:Connect(function()
            if character:FindFirstChild("HumanoidRootPart") then
                character.HumanoidRootPart.CFrame = character.HumanoidRootPart.CFrame * CFrame.Angles(0, math.rad(50), 0)
            end
        end)
    end
    
    -- 重新连接极速旋转
    if superSpinEnabled then
        if superSpinConnection then
            superSpinConnection:Disconnect()
        end
        superSpinConnection = RunService.Heartbeat:Connect(function()
            if character:FindFirstChild("HumanoidRootPart") then
                character.HumanoidRootPart.CFrame = character.HumanoidRootPart.CFrame * CFrame.Angles(0, math.rad(100), 0)
            end
        end)
    end
    
    -- 重新连接无限跳
    if infiniteJumpEnabled then
        if infiniteJumpConnection then
            infiniteJumpConnection:Disconnect()
        end
        infiniteJumpConnection = UserInputService.JumpRequest:Connect(function()
            if character:FindFirstChild("Humanoid") then
                character.Humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
            end
        end)
    end
    
    -- 重新连接夜视功能
    if nightVisionEnabled then
        Lighting.Brightness = 2
        Lighting.Ambient = Color3.new(1, 1, 1)
        Lighting.OutdoorAmbient = Color3.new(1, 1, 1)
    end
end)

-- 初始化
if verifiedPlayers[LocalPlayer.UserId] then
    KeyFrame.Visible = false
    WelcomeFrame.Visible = true
    FloatingBall.Visible = true
else
    KeyFrame.Visible = true
    WelcomeFrame.Visible = false
    FloatingBall.Visible = false
end
